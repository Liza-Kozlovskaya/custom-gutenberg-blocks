{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/index.js"],"names":["classnames","AsyncModeProvider","useSelect","useRef","createContext","useState","BlockListBlock","BlockListAppender","useBlockDropZone","useInsertionPoint","BlockPopover","store","blockEditorStore","useScrollSelectionIntoView","BlockNodes","SetBlockNodes","BlockList","className","ref","blockNodes","setBlockNodes","insertionPoint","Items","placeholder","rootClientId","renderAppender","__experimentalAppenderTagName","wrapperRef","selector","select","getBlockOrder","getBlockListSettings","getSelectedBlockClientId","getMultiSelectedBlockClientIds","hasMultiSelection","blockClientIds","selectedBlockClientId","multiSelectedBlockClientIds","orientation","dropTargetIndex","element","isAppenderDropTarget","length","map","clientId","index","isBlockInSelection","includes","isDropTarget","BlockListItems","props"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { AsyncModeProvider, useSelect } from '@wordpress/data';\nimport { useRef, createContext, useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport BlockListBlock from './block';\nimport BlockListAppender from '../block-list-appender';\nimport useBlockDropZone from '../use-block-drop-zone';\nimport useInsertionPoint from './insertion-point';\nimport BlockPopover from './block-popover';\nimport { store as blockEditorStore } from '../../store';\nimport { useScrollSelectionIntoView } from '../selection-scroll-into-view';\n\nexport const BlockNodes = createContext();\nexport const SetBlockNodes = createContext();\n\nexport default function BlockList( { className } ) {\n\tconst ref = useRef();\n\tconst [ blockNodes, setBlockNodes ] = useState( {} );\n\tconst insertionPoint = useInsertionPoint( ref );\n\tuseScrollSelectionIntoView( ref );\n\n\treturn (\n\t\t<BlockNodes.Provider value={ blockNodes }>\n\t\t\t{ insertionPoint }\n\t\t\t<BlockPopover />\n\t\t\t<div\n\t\t\t\tref={ ref }\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'block-editor-block-list__layout is-root-container',\n\t\t\t\t\tclassName\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t<SetBlockNodes.Provider value={ setBlockNodes }>\n\t\t\t\t\t<BlockListItems wrapperRef={ ref } />\n\t\t\t\t</SetBlockNodes.Provider>\n\t\t\t</div>\n\t\t</BlockNodes.Provider>\n\t);\n}\n\nfunction Items( {\n\tplaceholder,\n\trootClientId,\n\trenderAppender,\n\t__experimentalAppenderTagName,\n\twrapperRef,\n} ) {\n\tfunction selector( select ) {\n\t\tconst {\n\t\t\tgetBlockOrder,\n\t\t\tgetBlockListSettings,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetMultiSelectedBlockClientIds,\n\t\t\thasMultiSelection,\n\t\t} = select( blockEditorStore );\n\t\treturn {\n\t\t\tblockClientIds: getBlockOrder( rootClientId ),\n\t\t\tselectedBlockClientId: getSelectedBlockClientId(),\n\t\t\tmultiSelectedBlockClientIds: getMultiSelectedBlockClientIds(),\n\t\t\torientation: getBlockListSettings( rootClientId )?.orientation,\n\t\t\thasMultiSelection: hasMultiSelection(),\n\t\t};\n\t}\n\n\tconst {\n\t\tblockClientIds,\n\t\tselectedBlockClientId,\n\t\tmultiSelectedBlockClientIds,\n\t\torientation,\n\t\thasMultiSelection,\n\t} = useSelect( selector, [ rootClientId ] );\n\n\tconst dropTargetIndex = useBlockDropZone( {\n\t\telement: wrapperRef,\n\t\trootClientId,\n\t} );\n\n\tconst isAppenderDropTarget = dropTargetIndex === blockClientIds.length;\n\n\treturn (\n\t\t<>\n\t\t\t{ blockClientIds.map( ( clientId, index ) => {\n\t\t\t\tconst isBlockInSelection = hasMultiSelection\n\t\t\t\t\t? multiSelectedBlockClientIds.includes( clientId )\n\t\t\t\t\t: selectedBlockClientId === clientId;\n\n\t\t\t\tconst isDropTarget = dropTargetIndex === index;\n\n\t\t\t\treturn (\n\t\t\t\t\t<AsyncModeProvider\n\t\t\t\t\t\tkey={ clientId }\n\t\t\t\t\t\tvalue={ ! isBlockInSelection }\n\t\t\t\t\t>\n\t\t\t\t\t\t<BlockListBlock\n\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t// This prop is explicitely computed and passed down\n\t\t\t\t\t\t\t// to avoid being impacted by the async mode\n\t\t\t\t\t\t\t// otherwise there might be a small delay to trigger the animation.\n\t\t\t\t\t\t\tindex={ index }\n\t\t\t\t\t\t\tclassName={ classnames( {\n\t\t\t\t\t\t\t\t'is-drop-target': isDropTarget,\n\t\t\t\t\t\t\t\t'is-dropping-horizontally':\n\t\t\t\t\t\t\t\t\tisDropTarget &&\n\t\t\t\t\t\t\t\t\torientation === 'horizontal',\n\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</AsyncModeProvider>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t\t{ blockClientIds.length < 1 && placeholder }\n\t\t\t<BlockListAppender\n\t\t\t\ttagName={ __experimentalAppenderTagName }\n\t\t\t\trootClientId={ rootClientId }\n\t\t\t\trenderAppender={ renderAppender }\n\t\t\t\tclassName={ classnames( {\n\t\t\t\t\t'is-drop-target': isAppenderDropTarget,\n\t\t\t\t\t'is-dropping-horizontally':\n\t\t\t\t\t\tisAppenderDropTarget && orientation === 'horizontal',\n\t\t\t\t} ) }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport function BlockListItems( props ) {\n\t// This component needs to always be synchronous as it's the one changing\n\t// the async mode depending on the block selection.\n\treturn (\n\t\t<AsyncModeProvider value={ false }>\n\t\t\t<Items { ...props } />\n\t\t</AsyncModeProvider>\n\t);\n}\n"]}