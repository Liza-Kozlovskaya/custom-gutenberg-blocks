{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block.js"],"names":["classnames","omit","createContext","useMemo","useCallback","getBlockType","getSaveElement","isUnmodifiedDefaultBlock","hasBlockSupport","withFilters","withDispatch","withSelect","useDispatch","useSelect","compose","pure","ifCondition","BlockEdit","BlockInvalidWarning","BlockCrashWarning","BlockCrashBoundary","BlockHtml","useBlockProps","store","blockEditorStore","BlockListBlockContext","mergeWrapperProps","propsA","propsB","newProps","className","style","Block","children","isHtml","props","__unstableIsHtml","BlockListBlock","mode","isLocked","clientId","isSelected","isSelectionEnabled","name","isValid","attributes","wrapperProps","setAttributes","onReplace","onInsertBlocksAfter","onMerge","toggleSelection","index","removeBlock","onRemove","isTypingWithinBlock","select","isTyping","hasSelectedInnerBlock","blockEdit","undefined","blockType","lightBlockWrapper","apiVersion","getEditWrapperProps","isAligned","block","display","value","memoizedValue","Object","values","applyWithSelect","rootClientId","isBlockSelected","isFirstMultiSelectedBlock","getBlockMode","getTemplateLock","__unstableGetBlockWithoutInnerBlocks","getMultiSelectedBlockClientIds","templateLock","isFirstMultiSelected","multiSelectedClientIds","applyWithDispatch","dispatch","ownProps","updateBlockAttributes","insertBlocks","mergeBlocks","replaceBlocks","__unstableMarkLastChangeAsPersistent","newAttributes","clientIds","onInsertBlocks","blocks","getBlockIndex","forward","getPreviousBlockClientId","getNextBlockClientId","nextBlockClientId","previousBlockClientId","indexToSelect","initialPosition","length","selectionEnabled"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA,OAAOA,UAAP,MAAuB,YAAvB;AACA,SAASC,IAAT,QAAqB,QAArB;AAEA;AACA;AACA;;AACA,SAASC,aAAT,EAAwBC,OAAxB,EAAiCC,WAAjC,QAAoD,oBAApD;AACA,SACCC,YADD,EAECC,cAFD,EAGCC,wBAHD,EAICC,eAJD,QAKO,mBALP;AAMA,SAASC,WAAT,QAA4B,uBAA5B;AACA,SACCC,YADD,EAECC,UAFD,EAGCC,WAHD,EAICC,SAJD,QAKO,iBALP;AAMA,SAASC,OAAT,EAAkBC,IAAlB,EAAwBC,WAAxB,QAA2C,oBAA3C;AAEA;AACA;AACA;;AACA,OAAOC,SAAP,MAAsB,eAAtB;AACA,OAAOC,mBAAP,MAAgC,yBAAhC;AACA,OAAOC,iBAAP,MAA8B,uBAA9B;AACA,OAAOC,kBAAP,MAA+B,wBAA/B;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAASC,aAAT,QAA8B,mBAA9B;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,aAA1C;AAEA,OAAO,IAAMC,qBAAqB,GAAGvB,aAAa,EAA3C;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASwB,iBAAT,CAA4BC,MAA5B,EAAoCC,MAApC,EAA6C;AAC5C,MAAMC,QAAQ,mCACVF,MADU,GAEVC,MAFU,CAAd;;AAKA,MAAKD,MAAM,IAAIC,MAAV,IAAoBD,MAAM,CAACG,SAA3B,IAAwCF,MAAM,CAACE,SAApD,EAAgE;AAC/DD,IAAAA,QAAQ,CAACC,SAAT,GAAqB9B,UAAU,CAAE2B,MAAM,CAACG,SAAT,EAAoBF,MAAM,CAACE,SAA3B,CAA/B;AACA;;AACD,MAAKH,MAAM,IAAIC,MAAV,IAAoBD,MAAM,CAACI,KAA3B,IAAoCH,MAAM,CAACG,KAAhD,EAAwD;AACvDF,IAAAA,QAAQ,CAACE,KAAT,mCAAsBJ,MAAM,CAACI,KAA7B,GAAuCH,MAAM,CAACG,KAA9C;AACA;;AAED,SAAOF,QAAP;AACA;;AAED,SAASG,KAAT,OAAiD;AAAA,MAA/BC,QAA+B,QAA/BA,QAA+B;AAAA,MAArBC,MAAqB,QAArBA,MAAqB;AAAA,MAAVC,KAAU;;AAChD,SACC,qBAAUb,aAAa,CAAEa,KAAF,EAAS;AAAEC,IAAAA,gBAAgB,EAAEF;AAApB,GAAT,CAAvB,EACGD,QADH,CADD;AAKA;;AAED,SAASI,cAAT,QAiBI;AAAA,MAhBHC,IAgBG,SAhBHA,IAgBG;AAAA,MAfHC,QAeG,SAfHA,QAeG;AAAA,MAdHC,QAcG,SAdHA,QAcG;AAAA,MAbHC,UAaG,SAbHA,UAaG;AAAA,MAZHC,kBAYG,SAZHA,kBAYG;AAAA,MAXHZ,SAWG,SAXHA,SAWG;AAAA,MAVHa,IAUG,SAVHA,IAUG;AAAA,MATHC,OASG,SATHA,OASG;AAAA,MARHC,UAQG,SARHA,UAQG;AAAA,MAPHC,YAOG,SAPHA,YAOG;AAAA,MANHC,aAMG,SANHA,aAMG;AAAA,MALHC,SAKG,SALHA,SAKG;AAAA,MAJHC,mBAIG,SAJHA,mBAIG;AAAA,MAHHC,OAGG,SAHHA,OAGG;AAAA,MAFHC,eAEG,SAFHA,eAEG;AAAA,MADHC,KACG,SADHA,KACG;;AAAA,qBACqBxC,WAAW,CAAEY,gBAAF,CADhC;AAAA,MACK6B,WADL,gBACKA,WADL;;AAEH,MAAMC,QAAQ,GAAGlD,WAAW,CAAE;AAAA,WAAMiD,WAAW,CAAEb,QAAF,CAAjB;AAAA,GAAF,EAAiC,CAAEA,QAAF,CAAjC,CAA5B;AACA,MAAMe,mBAAmB,GAAG1C,SAAS,CACpC,UAAE2C,MAAF,EAAc;AAAA,kBAC+BA,MAAM,CACjDhC,gBADiD,CADrC;AAAA,QACLiC,QADK,WACLA,QADK;AAAA,QACKC,qBADL,WACKA,qBADL;;AAIb,WACC;AACA;AACA;AACA,OAAEjB,UAAU,IAAIiB,qBAAqB,CAAElB,QAAF,EAAY,IAAZ,CAArC,KACAiB,QAAQ;AALT;AAOA,GAZmC,EAapC,CAAEjB,QAAF,EAAYC,UAAZ,CAboC,CAArC,CAHG,CAmBH;AACA;AACA;AACA;;AACA,MAAIkB,SAAS,GACZ,cAAC,SAAD;AACC,IAAA,IAAI,EAAGhB,IADR;AAEC,IAAA,UAAU,EAAGF,UAFd;AAGC,IAAA,UAAU,EAAGI,UAHd;AAIC,IAAA,aAAa,EAAGE,aAJjB;AAKC,IAAA,iBAAiB,EAAGR,QAAQ,GAAGqB,SAAH,GAAeX,mBAL5C;AAMC,IAAA,SAAS,EAAGV,QAAQ,GAAGqB,SAAH,GAAeZ,SANpC;AAOC,IAAA,QAAQ,EAAGT,QAAQ,GAAGqB,SAAH,GAAeN,QAPnC;AAQC,IAAA,WAAW,EAAGf,QAAQ,GAAGqB,SAAH,GAAeV,OARtC;AASC,IAAA,QAAQ,EAAGV,QATZ;AAUC,IAAA,kBAAkB,EAAGE,kBAVtB;AAWC,IAAA,eAAe,EAAGS;AAXnB,IADD;AAgBA,MAAMU,SAAS,GAAGxD,YAAY,CAAEsC,IAAF,CAA9B;AACA,MAAMmB,iBAAiB,GACtBD,SAAS,CAACE,UAAV,GAAuB,CAAvB,IACAvD,eAAe,CAAEqD,SAAF,EAAa,mBAAb,EAAkC,KAAlC,CAFhB,CAxCG,CA4CH;;AACA,MAAKA,SAAS,CAACG,mBAAf,EAAqC;AACpClB,IAAAA,YAAY,GAAGpB,iBAAiB,CAC/BoB,YAD+B,EAE/Be,SAAS,CAACG,mBAAV,CAA+BnB,UAA/B,CAF+B,CAAhC;AAIA;;AAED,MAAMoB,SAAS,GAAGnB,YAAY,IAAI,CAAC,CAAEA,YAAY,CAAE,YAAF,CAAjD,CApDG,CAsDH;AACA;;AACA,MAAKmB,SAAL,EAAiB;AAChBN,IAAAA,SAAS,GACR;AACC,MAAA,SAAS,EAAC,UADX;AAEC,oBAAab,YAAY,CAAE,YAAF;AAF1B,OAIGa,SAJH,CADD;AAQA;;AAED,MAAIO,KAAJ;;AAEA,MAAK,CAAEtB,OAAP,EAAiB;AAChBsB,IAAAA,KAAK,GACJ,cAAC,KAAD;AAAO,MAAA,SAAS,EAAC;AAAjB,OACC,cAAC,mBAAD;AAAqB,MAAA,QAAQ,EAAG1B;AAAhC,MADD,EAEC,2BAAOlC,cAAc,CAAEuD,SAAF,EAAahB,UAAb,CAArB,CAFD,CADD;AAMA,GAPD,MAOO,IAAKP,IAAI,KAAK,MAAd,EAAuB;AAC7B;AACA;AACA4B,IAAAA,KAAK,GACJ,8BACC;AAAK,MAAA,KAAK,EAAG;AAAEC,QAAAA,OAAO,EAAE;AAAX;AAAb,OAAqCR,SAArC,CADD,EAEC,cAAC,KAAD;AAAO,MAAA,MAAM;AAAb,OACC,cAAC,SAAD;AAAW,MAAA,QAAQ,EAAGnB;AAAtB,MADD,CAFD,CADD;AAQA,GAXM,MAWA,IAAKsB,iBAAL,EAAyB;AAC/BI,IAAAA,KAAK,GAAGP,SAAR;AACA,GAFM,MAEA;AACNO,IAAAA,KAAK,GAAG,cAAC,KAAD,EAAYpB,YAAZ,EAA6Ba,SAA7B,CAAR;AACA;;AAED,MAAMS,KAAK,GAAG;AACb5B,IAAAA,QAAQ,EAARA,QADa;AAEbC,IAAAA,UAAU,EAAVA,UAFa;AAGbW,IAAAA,KAAK,EAALA,KAHa;AAIb;AACAtB,IAAAA,SAAS,EAAE9B,UAAU,CAAE8B,SAAF,EAAa;AACjC,kBAAY,CAAEmC,SADmB;AAEjC,mBAAaV;AAFoB,KAAb,CALR;AASbT,IAAAA,YAAY,EAAE7C,IAAI,CAAE6C,YAAF,EAAgB,CAAE,YAAF,CAAhB;AATL,GAAd;AAWA,MAAMuB,aAAa,GAAGlE,OAAO,CAAE;AAAA,WAAMiE,KAAN;AAAA,GAAF,EAAeE,MAAM,CAACC,MAAP,CAAeH,KAAf,CAAf,CAA7B;AAEA,SACC,cAAC,qBAAD,CAAuB,QAAvB;AAAgC,IAAA,KAAK,EAAGC;AAAxC,KACC,cAAC,kBAAD;AACC,IAAA,QAAQ,EACP,cAAC,KAAD;AAAO,MAAA,SAAS,EAAC;AAAjB,OACC,cAAC,iBAAD,OADD;AAFF,KAOGH,KAPH,CADD,CADD;AAaA;;AAED,IAAMM,eAAe,GAAG7D,UAAU,CAAE,UAAE6C,MAAF,SAA0C;AAAA,MAA9BhB,QAA8B,SAA9BA,QAA8B;AAAA,MAApBiC,YAAoB,SAApBA,YAAoB;;AAAA,iBASzEjB,MAAM,CAAEhC,gBAAF,CATmE;AAAA,MAE5EkD,eAF4E,YAE5EA,eAF4E;AAAA,MAG5EC,yBAH4E,YAG5EA,yBAH4E;AAAA,MAI5EC,YAJ4E,YAI5EA,YAJ4E;AAAA,MAK5ElC,kBAL4E,YAK5EA,kBAL4E;AAAA,MAM5EmC,eAN4E,YAM5EA,eAN4E;AAAA,MAO5EC,oCAP4E,YAO5EA,oCAP4E;AAAA,MAQ5EC,8BAR4E,YAQ5EA,8BAR4E;;AAU7E,MAAMb,KAAK,GAAGY,oCAAoC,CAAEtC,QAAF,CAAlD;;AACA,MAAMC,UAAU,GAAGiC,eAAe,CAAElC,QAAF,CAAlC;AACA,MAAMwC,YAAY,GAAGH,eAAe,CAAEJ,YAAF,CAApC,CAZ6E,CAa7E;AACA;AACA;AACA;;AAhB6E,cAiBvCP,KAAK,IAAI,EAjB8B;AAAA,MAiBrEvB,IAjBqE,SAiBrEA,IAjBqE;AAAA,MAiB/DE,UAjB+D,SAiB/DA,UAjB+D;AAAA,MAiBnDD,OAjBmD,SAiBnDA,OAjBmD;;AAkB7E,MAAMqC,oBAAoB,GAAGN,yBAAyB,CAAEnC,QAAF,CAAtD,CAlB6E,CAoB7E;AACA;;AACA,SAAO;AACNyC,IAAAA,oBAAoB,EAApBA,oBADM;AAENC,IAAAA,sBAAsB,EAAED,oBAAoB,GACzCF,8BAA8B,EADW,GAEzCnB,SAJG;AAKNtB,IAAAA,IAAI,EAAEsC,YAAY,CAAEpC,QAAF,CALZ;AAMNE,IAAAA,kBAAkB,EAAEA,kBAAkB,EANhC;AAONH,IAAAA,QAAQ,EAAE,CAAC,CAAEyC,YAPP;AAQN;AACA;AACA;AACA;AACAd,IAAAA,KAAK,EAALA,KAZM;AAaNvB,IAAAA,IAAI,EAAJA,IAbM;AAcNE,IAAAA,UAAU,EAAVA,UAdM;AAeND,IAAAA,OAAO,EAAPA,OAfM;AAgBNH,IAAAA,UAAU,EAAVA;AAhBM,GAAP;AAkBA,CAxCiC,CAAlC;AA0CA,IAAM0C,iBAAiB,GAAGzE,YAAY,CAAE,UAAE0E,QAAF,EAAYC,QAAZ,SAAsC;AAAA,MAAd7B,MAAc,SAAdA,MAAc;;AAAA,kBAQzE4B,QAAQ,CAAE5D,gBAAF,CARiE;AAAA,MAE5E8D,qBAF4E,aAE5EA,qBAF4E;AAAA,MAG5EC,YAH4E,aAG5EA,YAH4E;AAAA,MAI5EC,WAJ4E,aAI5EA,WAJ4E;AAAA,MAK5EC,aAL4E,aAK5EA,aAL4E;AAAA,MAM5EtC,gBAN4E,aAM5EA,eAN4E;AAAA,MAO5EuC,oCAP4E,aAO5EA,oCAP4E,EAU7E;AACA;;;AACA,SAAO;AACN3C,IAAAA,aADM,yBACS4C,aADT,EACyB;AAAA,UAE7BnD,QAF6B,GAK1B6C,QAL0B,CAE7B7C,QAF6B;AAAA,UAG7ByC,oBAH6B,GAK1BI,QAL0B,CAG7BJ,oBAH6B;AAAA,UAI7BC,sBAJ6B,GAK1BG,QAL0B,CAI7BH,sBAJ6B;AAM9B,UAAMU,SAAS,GAAGX,oBAAoB,GACnCC,sBADmC,GAEnC,CAAE1C,QAAF,CAFH;AAIA8C,MAAAA,qBAAqB,CAAEM,SAAF,EAAaD,aAAb,CAArB;AACA,KAZK;AAaNE,IAAAA,cAbM,0BAaUC,MAbV,EAakB1C,KAblB,EAa0B;AAAA,UACvBqB,YADuB,GACNY,QADM,CACvBZ,YADuB;AAE/Bc,MAAAA,YAAY,CAAEO,MAAF,EAAU1C,KAAV,EAAiBqB,YAAjB,CAAZ;AACA,KAhBK;AAiBNxB,IAAAA,mBAjBM,+BAiBe6C,MAjBf,EAiBwB;AAAA,UACrBtD,QADqB,GACM6C,QADN,CACrB7C,QADqB;AAAA,UACXiC,YADW,GACMY,QADN,CACXZ,YADW;;AAAA,qBAEHjB,MAAM,CAAEhC,gBAAF,CAFH;AAAA,UAErBuE,aAFqB,YAErBA,aAFqB;;AAG7B,UAAM3C,KAAK,GAAG2C,aAAa,CAAEvD,QAAF,EAAYiC,YAAZ,CAA3B;AACAc,MAAAA,YAAY,CAAEO,MAAF,EAAU1C,KAAK,GAAG,CAAlB,EAAqBqB,YAArB,CAAZ;AACA,KAtBK;AAuBNvB,IAAAA,OAvBM,mBAuBG8C,OAvBH,EAuBa;AAAA,UACVxD,QADU,GACG6C,QADH,CACV7C,QADU;;AAAA,qBAEyCgB,MAAM,CAChEhC,gBADgE,CAF/C;AAAA,UAEVyE,wBAFU,YAEVA,wBAFU;AAAA,UAEgBC,oBAFhB,YAEgBA,oBAFhB;;AAMlB,UAAKF,OAAL,EAAe;AACd,YAAMG,iBAAiB,GAAGD,oBAAoB,CAAE1D,QAAF,CAA9C;;AACA,YAAK2D,iBAAL,EAAyB;AACxBX,UAAAA,WAAW,CAAEhD,QAAF,EAAY2D,iBAAZ,CAAX;AACA;AACD,OALD,MAKO;AACN,YAAMC,qBAAqB,GAAGH,wBAAwB,CACrDzD,QADqD,CAAtD;;AAGA,YAAK4D,qBAAL,EAA6B;AAC5BZ,UAAAA,WAAW,CAAEY,qBAAF,EAAyB5D,QAAzB,CAAX;AACA;AACD;AACD,KA1CK;AA2CNQ,IAAAA,SA3CM,qBA2CK8C,MA3CL,EA2CaO,aA3Cb,EA2C4BC,eA3C5B,EA2C8C;AACnD,UACCR,MAAM,CAACS,MAAP,IACA,CAAEhG,wBAAwB,CAAEuF,MAAM,CAAEA,MAAM,CAACS,MAAP,GAAgB,CAAlB,CAAR,CAF3B,EAGE;AACDb,QAAAA,oCAAoC;AACpC;;AACDD,MAAAA,aAAa,CACZ,CAAEJ,QAAQ,CAAC7C,QAAX,CADY,EAEZsD,MAFY,EAGZO,aAHY,EAIZC,eAJY,CAAb;AAMA,KAxDK;AAyDNnD,IAAAA,eAzDM,2BAyDWqD,gBAzDX,EAyD8B;AACnCrD,MAAAA,gBAAe,CAAEqD,gBAAF,CAAf;AACA;AA3DK,GAAP;AA6DA,CAzEqC,CAAtC;AA2EA,eAAe1F,OAAO,CACrBC,IADqB,EAErByD,eAFqB,EAGrBW,iBAHqB,EAIrB;AACA;AACA;AACAnE,WAAW,CAAE;AAAA,MAAIkD,KAAJ,SAAIA,KAAJ;AAAA,SAAiB,CAAC,CAAEA,KAApB;AAAA,CAAF,CAPU,EAQrBzD,WAAW,CAAE,uBAAF,CARU,CAAP,CASZ4B,cATY,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { createContext, useMemo, useCallback } from '@wordpress/element';\nimport {\n\tgetBlockType,\n\tgetSaveElement,\n\tisUnmodifiedDefaultBlock,\n\thasBlockSupport,\n} from '@wordpress/blocks';\nimport { withFilters } from '@wordpress/components';\nimport {\n\twithDispatch,\n\twithSelect,\n\tuseDispatch,\n\tuseSelect,\n} from '@wordpress/data';\nimport { compose, pure, ifCondition } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockEdit from '../block-edit';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockCrashWarning from './block-crash-warning';\nimport BlockCrashBoundary from './block-crash-boundary';\nimport BlockHtml from './block-html';\nimport { useBlockProps } from './use-block-props';\nimport { store as blockEditorStore } from '../../store';\n\nexport const BlockListBlockContext = createContext();\n\n/**\n * Merges wrapper props with special handling for classNames and styles.\n *\n * @param {Object} propsA\n * @param {Object} propsB\n *\n * @return {Object} Merged props.\n */\nfunction mergeWrapperProps( propsA, propsB ) {\n\tconst newProps = {\n\t\t...propsA,\n\t\t...propsB,\n\t};\n\n\tif ( propsA && propsB && propsA.className && propsB.className ) {\n\t\tnewProps.className = classnames( propsA.className, propsB.className );\n\t}\n\tif ( propsA && propsB && propsA.style && propsB.style ) {\n\t\tnewProps.style = { ...propsA.style, ...propsB.style };\n\t}\n\n\treturn newProps;\n}\n\nfunction Block( { children, isHtml, ...props } ) {\n\treturn (\n\t\t<div { ...useBlockProps( props, { __unstableIsHtml: isHtml } ) }>\n\t\t\t{ children }\n\t\t</div>\n\t);\n}\n\nfunction BlockListBlock( {\n\tmode,\n\tisLocked,\n\tclientId,\n\tisSelected,\n\tisSelectionEnabled,\n\tclassName,\n\tname,\n\tisValid,\n\tattributes,\n\twrapperProps,\n\tsetAttributes,\n\tonReplace,\n\tonInsertBlocksAfter,\n\tonMerge,\n\ttoggleSelection,\n\tindex,\n} ) {\n\tconst { removeBlock } = useDispatch( blockEditorStore );\n\tconst onRemove = useCallback( () => removeBlock( clientId ), [ clientId ] );\n\tconst isTypingWithinBlock = useSelect(\n\t\t( select ) => {\n\t\t\tconst { isTyping, hasSelectedInnerBlock } = select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\t\t\treturn (\n\t\t\t\t// We only care about this prop when the block is selected\n\t\t\t\t// Thus to avoid unnecessary rerenders we avoid updating the\n\t\t\t\t// prop if the block is not selected.\n\t\t\t\t( isSelected || hasSelectedInnerBlock( clientId, true ) ) &&\n\t\t\t\tisTyping()\n\t\t\t);\n\t\t},\n\t\t[ clientId, isSelected ]\n\t);\n\n\t// We wrap the BlockEdit component in a div that hides it when editing in\n\t// HTML mode. This allows us to render all of the ancillary pieces\n\t// (InspectorControls, etc.) which are inside `BlockEdit` but not\n\t// `BlockHTML`, even in HTML mode.\n\tlet blockEdit = (\n\t\t<BlockEdit\n\t\t\tname={ name }\n\t\t\tisSelected={ isSelected }\n\t\t\tattributes={ attributes }\n\t\t\tsetAttributes={ setAttributes }\n\t\t\tinsertBlocksAfter={ isLocked ? undefined : onInsertBlocksAfter }\n\t\t\tonReplace={ isLocked ? undefined : onReplace }\n\t\t\tonRemove={ isLocked ? undefined : onRemove }\n\t\t\tmergeBlocks={ isLocked ? undefined : onMerge }\n\t\t\tclientId={ clientId }\n\t\t\tisSelectionEnabled={ isSelectionEnabled }\n\t\t\ttoggleSelection={ toggleSelection }\n\t\t/>\n\t);\n\n\tconst blockType = getBlockType( name );\n\tconst lightBlockWrapper =\n\t\tblockType.apiVersion > 1 ||\n\t\thasBlockSupport( blockType, 'lightBlockWrapper', false );\n\n\t// Determine whether the block has props to apply to the wrapper.\n\tif ( blockType.getEditWrapperProps ) {\n\t\twrapperProps = mergeWrapperProps(\n\t\t\twrapperProps,\n\t\t\tblockType.getEditWrapperProps( attributes )\n\t\t);\n\t}\n\n\tconst isAligned = wrapperProps && !! wrapperProps[ 'data-align' ];\n\n\t// For aligned blocks, provide a wrapper element so the block can be\n\t// positioned relative to the block column.\n\tif ( isAligned ) {\n\t\tblockEdit = (\n\t\t\t<div\n\t\t\t\tclassName=\"wp-block\"\n\t\t\t\tdata-align={ wrapperProps[ 'data-align' ] }\n\t\t\t>\n\t\t\t\t{ blockEdit }\n\t\t\t</div>\n\t\t);\n\t}\n\n\tlet block;\n\n\tif ( ! isValid ) {\n\t\tblock = (\n\t\t\t<Block className=\"has-warning\">\n\t\t\t\t<BlockInvalidWarning clientId={ clientId } />\n\t\t\t\t<div>{ getSaveElement( blockType, attributes ) }</div>\n\t\t\t</Block>\n\t\t);\n\t} else if ( mode === 'html' ) {\n\t\t// Render blockEdit so the inspector controls don't disappear.\n\t\t// See #8969.\n\t\tblock = (\n\t\t\t<>\n\t\t\t\t<div style={ { display: 'none' } }>{ blockEdit }</div>\n\t\t\t\t<Block isHtml>\n\t\t\t\t\t<BlockHtml clientId={ clientId } />\n\t\t\t\t</Block>\n\t\t\t</>\n\t\t);\n\t} else if ( lightBlockWrapper ) {\n\t\tblock = blockEdit;\n\t} else {\n\t\tblock = <Block { ...wrapperProps }>{ blockEdit }</Block>;\n\t}\n\n\tconst value = {\n\t\tclientId,\n\t\tisSelected,\n\t\tindex,\n\t\t// The wp-block className is important for editor styles.\n\t\tclassName: classnames( className, {\n\t\t\t'wp-block': ! isAligned,\n\t\t\t'is-typing': isTypingWithinBlock,\n\t\t} ),\n\t\twrapperProps: omit( wrapperProps, [ 'data-align' ] ),\n\t};\n\tconst memoizedValue = useMemo( () => value, Object.values( value ) );\n\n\treturn (\n\t\t<BlockListBlockContext.Provider value={ memoizedValue }>\n\t\t\t<BlockCrashBoundary\n\t\t\t\tfallback={\n\t\t\t\t\t<Block className=\"has-warning\">\n\t\t\t\t\t\t<BlockCrashWarning />\n\t\t\t\t\t</Block>\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{ block }\n\t\t\t</BlockCrashBoundary>\n\t\t</BlockListBlockContext.Provider>\n\t);\n}\n\nconst applyWithSelect = withSelect( ( select, { clientId, rootClientId } ) => {\n\tconst {\n\t\tisBlockSelected,\n\t\tisFirstMultiSelectedBlock,\n\t\tgetBlockMode,\n\t\tisSelectionEnabled,\n\t\tgetTemplateLock,\n\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\tgetMultiSelectedBlockClientIds,\n\t} = select( blockEditorStore );\n\tconst block = __unstableGetBlockWithoutInnerBlocks( clientId );\n\tconst isSelected = isBlockSelected( clientId );\n\tconst templateLock = getTemplateLock( rootClientId );\n\t// The fallback to `{}` is a temporary fix.\n\t// This function should never be called when a block is not present in\n\t// the state. It happens now because the order in withSelect rendering\n\t// is not correct.\n\tconst { name, attributes, isValid } = block || {};\n\tconst isFirstMultiSelected = isFirstMultiSelectedBlock( clientId );\n\n\t// Do not add new properties here, use `useSelect` instead to avoid\n\t// leaking new props to the public API (editor.BlockListBlock filter).\n\treturn {\n\t\tisFirstMultiSelected,\n\t\tmultiSelectedClientIds: isFirstMultiSelected\n\t\t\t? getMultiSelectedBlockClientIds()\n\t\t\t: undefined,\n\t\tmode: getBlockMode( clientId ),\n\t\tisSelectionEnabled: isSelectionEnabled(),\n\t\tisLocked: !! templateLock,\n\t\t// Users of the editor.BlockListBlock filter used to be able to\n\t\t// access the block prop.\n\t\t// Ideally these blocks would rely on the clientId prop only.\n\t\t// This is kept for backward compatibility reasons.\n\t\tblock,\n\t\tname,\n\t\tattributes,\n\t\tisValid,\n\t\tisSelected,\n\t};\n} );\n\nconst applyWithDispatch = withDispatch( ( dispatch, ownProps, { select } ) => {\n\tconst {\n\t\tupdateBlockAttributes,\n\t\tinsertBlocks,\n\t\tmergeBlocks,\n\t\treplaceBlocks,\n\t\ttoggleSelection,\n\t\t__unstableMarkLastChangeAsPersistent,\n\t} = dispatch( blockEditorStore );\n\n\t// Do not add new properties here, use `useDispatch` instead to avoid\n\t// leaking new props to the public API (editor.BlockListBlock filter).\n\treturn {\n\t\tsetAttributes( newAttributes ) {\n\t\t\tconst {\n\t\t\t\tclientId,\n\t\t\t\tisFirstMultiSelected,\n\t\t\t\tmultiSelectedClientIds,\n\t\t\t} = ownProps;\n\t\t\tconst clientIds = isFirstMultiSelected\n\t\t\t\t? multiSelectedClientIds\n\t\t\t\t: [ clientId ];\n\n\t\t\tupdateBlockAttributes( clientIds, newAttributes );\n\t\t},\n\t\tonInsertBlocks( blocks, index ) {\n\t\t\tconst { rootClientId } = ownProps;\n\t\t\tinsertBlocks( blocks, index, rootClientId );\n\t\t},\n\t\tonInsertBlocksAfter( blocks ) {\n\t\t\tconst { clientId, rootClientId } = ownProps;\n\t\t\tconst { getBlockIndex } = select( blockEditorStore );\n\t\t\tconst index = getBlockIndex( clientId, rootClientId );\n\t\t\tinsertBlocks( blocks, index + 1, rootClientId );\n\t\t},\n\t\tonMerge( forward ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst { getPreviousBlockClientId, getNextBlockClientId } = select(\n\t\t\t\tblockEditorStore\n\t\t\t);\n\n\t\t\tif ( forward ) {\n\t\t\t\tconst nextBlockClientId = getNextBlockClientId( clientId );\n\t\t\t\tif ( nextBlockClientId ) {\n\t\t\t\t\tmergeBlocks( clientId, nextBlockClientId );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst previousBlockClientId = getPreviousBlockClientId(\n\t\t\t\t\tclientId\n\t\t\t\t);\n\t\t\t\tif ( previousBlockClientId ) {\n\t\t\t\t\tmergeBlocks( previousBlockClientId, clientId );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonReplace( blocks, indexToSelect, initialPosition ) {\n\t\t\tif (\n\t\t\t\tblocks.length &&\n\t\t\t\t! isUnmodifiedDefaultBlock( blocks[ blocks.length - 1 ] )\n\t\t\t) {\n\t\t\t\t__unstableMarkLastChangeAsPersistent();\n\t\t\t}\n\t\t\treplaceBlocks(\n\t\t\t\t[ ownProps.clientId ],\n\t\t\t\tblocks,\n\t\t\t\tindexToSelect,\n\t\t\t\tinitialPosition\n\t\t\t);\n\t\t},\n\t\ttoggleSelection( selectionEnabled ) {\n\t\t\ttoggleSelection( selectionEnabled );\n\t\t},\n\t};\n} );\n\nexport default compose(\n\tpure,\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\t// block is sometimes not mounted at the right time, causing it be undefined\n\t// see issue for more info\n\t// https://github.com/WordPress/gutenberg/issues/17013\n\tifCondition( ( { block } ) => !! block ),\n\twithFilters( 'editor.BlockListBlock' )\n)( BlockListBlock );\n"]}